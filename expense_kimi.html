<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üí∞ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢</title>
    <style>
        /* üé® Modern Blue Theme Variables */
        :root {
            --primary-blue: #2196F3;
            --primary-dark: #1976D2;
            --primary-light: #BBDEFB;
            --accent-blue: #03A9F4;
            --success-green: #4CAF50;
            --danger-red: #F44336;
            --warning-orange: #FF9800;
            --bg-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --card-shadow: 0 4px 20px rgba(0,0,0,0.1);
            --card-shadow-hover: 0 8px 30px rgba(0,0,0,0.15);
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--bg-gradient);
            min-height: 100vh;
            color: #333;
            line-height: 1.6;
        }

        /* üì± Mobile Responsive Container */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* üè† Dashboard Header */
        .dashboard-header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: var(--card-shadow);
            text-align: center;
        }

        .dashboard-header h1 {
            color: var(--primary-dark);
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 10px;
            background: linear-gradient(135deg, var(--primary-blue), var(--accent-blue));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .dashboard-header p {
            color: #666;
            font-size: 1.1rem;
        }

        /* üìä Summary Cards Grid */
        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .summary-card {
            background: white;
            border-radius: 16px;
            padding: 25px;
            box-shadow: var(--card-shadow);
            transition: var(--transition);
            position: relative;
            overflow: hidden;
        }

        .summary-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--primary-blue);
            transform: scaleX(0);
            transition: transform 0.3s ease;
        }

        .summary-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--card-shadow-hover);
        }

        .summary-card:hover::before {
            transform: scaleX(1);
        }

        .summary-card h3 {
            color: #666;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 10px;
        }

        .summary-card .amount {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .income { color: var(--success-green); }
        .expense { color: var(--danger-red); }
        .balance { color: var(--primary-blue); }

        /* üìù Form Section */
        .form-section {
            background: white;
            border-radius: 16px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: var(--card-shadow);
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group label {
            color: #555;
            font-weight: 600;
            margin-bottom: 8px;
            font-size: 0.9rem;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            padding: 12px 16px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1rem;
            transition: var(--transition);
            background: #fafafa;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--primary-blue);
            background: white;
            box-shadow: 0 0 0 3px rgba(33, 150, 243, 0.1);
        }

        /* üéØ Button Styles */
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary-blue), var(--accent-blue));
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(33, 150, 243, 0.3);
        }

        .btn-success {
            background: linear-gradient(135deg, var(--success-green), #66BB6A);
            color: white;
        }

        .btn-danger {
            background: linear-gradient(135deg, var(--danger-red), #EF5350);
            color: white;
        }

        .btn-warning {
            background: linear-gradient(135deg, var(--warning-orange), #FFB74D);
            color: white;
        }

        .btn-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        /* üìã Transaction List */
        .transaction-section {
            background: white;
            border-radius: 16px;
            padding: 30px;
            box-shadow: var(--card-shadow);
        }

        .filter-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .tab-btn {
            padding: 8px 16px;
            border: 2px solid #e0e0e0;
            background: white;
            border-radius: 20px;
            cursor: pointer;
            transition: var(--transition);
            font-weight: 600;
        }

        .tab-btn.active {
            background: var(--primary-blue);
            color: white;
            border-color: var(--primary-blue);
        }

        .transaction-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px;
            margin-bottom: 10px;
            border-radius: 12px;
            transition: var(--transition);
            position: relative;
            overflow: hidden;
        }

        .transaction-item::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 4px;
            transition: width 0.3s ease;
        }

        .transaction-item.income {
            background: linear-gradient(135deg, #E8F5E9, #C8E6C9);
        }

        .transaction-item.income::before {
            background: var(--success-green);
        }

        .transaction-item.expense {
            background: linear-gradient(135deg, #FFEBEE, #FFCDD2);
        }

        .transaction-item.expense::before {
            background: var(--danger-red);
        }

        .transaction-item:hover {
            transform: translateX(5px);
            box-shadow: var(--card-shadow);
        }

        .transaction-item:hover::before {
            width: 8px;
        }

        .transaction-info {
            flex: 1;
        }

        .transaction-title {
            font-weight: 600;
            margin-bottom: 4px;
        }

        .transaction-meta {
            font-size: 0.8rem;
            color: #666;
        }

        .transaction-amount {
            font-size: 1.2rem;
            font-weight: 700;
            margin-right: 15px;
        }

        .action-buttons {
            display: flex;
            gap: 5px;
        }

        .icon-btn {
            width: 32px;
            height: 32px;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
        }

        .edit-btn {
            background: var(--primary-light);
            color: var(--primary-dark);
        }

        .delete-btn {
            background: #FFCDD2;
            color: var(--danger-red);
        }

        /* üì± Mobile Responsive */
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }

            .dashboard-header h1 {
                font-size: 2rem;
            }

            .summary-grid {
                grid-template-columns: 1fr;
            }

            .form-grid {
                grid-template-columns: 1fr;
            }

            .btn-group {
                flex-direction: column;
            }

            .transaction-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }

            .transaction-amount {
                margin-right: 0;
            }
        }

        /* üé® Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            backdrop-filter: blur(5px);
            z-index: 1000;
            animation: fadeIn 0.3s ease;
        }

        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            border-radius: 16px;
            padding: 30px;
            max-width: 500px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            animation: slideIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideIn {
            from { transform: translate(-50%, -60%); opacity: 0; }
            to { transform: translate(-50%, -50%); opacity: 1; }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #f0f0f0;
        }

        .modal-header h2 {
            color: var(--primary-dark);
            font-size: 1.5rem;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #999;
            transition: color 0.3s ease;
        }

        .close-btn:hover {
            color: #333;
        }

        /* üìä Chart Container */
        .chart-container {
            background: white;
            border-radius: 16px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: var(--card-shadow);
            height: 300px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #999;
            font-size: 1.1rem;
        }

        /* üîç Loading Animation */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid var(--primary-blue);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* üéØ Utility Classes */
        .text-center { text-align: center; }
        .mb-20 { margin-bottom: 20px; }
        .mt-20 { margin-top: 20px; }
        .hidden { display: none; }
        .fade-in { animation: fadeIn 0.5s ease; }
    </style>
</head>
<body>
    <div class="container">
        <!-- üè† Dashboard Header -->
        <div class="dashboard-header">
            <h1>üí∞ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢</h1>
            <p>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û</p>
        </div>

        <!-- üìä Summary Cards -->
        <div class="summary-grid">
            <div class="summary-card">
                <h3>üíö ‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h3>
                <div class="amount income" id="totalIncome">‡∏ø0.00</div>
                <small>‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô</small>
            </div>
            <div class="summary-card">
                <h3>‚ù§Ô∏è ‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h3>
                <div class="amount expense" id="totalExpense">‡∏ø0.00</div>
                <small>‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô</small>
            </div>
            <div class="summary-card">
                <h3>üíô ‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠</h3>
                <div class="amount balance" id="balance">‡∏ø0.00</div>
                <small>‡∏¢‡∏≠‡∏î‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏™‡∏∏‡∏ó‡∏ò‡∏¥</small>
            </div>
            <div class="summary-card">
                <h3>üìä ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</h3>
                <div class="amount" id="transactionCount">0</div>
                <small>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</small>
            </div>
        </div>

        <!-- üìã Transaction List -->
        <div class="transaction-section">
            <h2 class="mb-20">üìã ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ò‡∏∏‡∏£‡∏Å‡∏£‡∏£‡∏°</h2>
            
            <!-- üîç Filter Tabs -->
            <div class="filter-tabs">
                <button class="tab-btn active" data-filter="all">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
                <button class="tab-btn" data-filter="daily">‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô</button>
                <button class="tab-btn" data-filter="weekly">‡∏£‡∏≤‡∏¢‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå</button>
                <button class="tab-btn" data-filter="monthly">‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</button>
                <button class="tab-btn" data-filter="yearly">‡∏£‡∏≤‡∏¢‡∏õ‡∏µ</button>
            </div>

            <!-- üìù Add Transaction Button -->
            <div class="mb-20">
                <button class="btn btn-primary" onclick="openAddModal()">
                    ‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà
                </button>
                <button class="btn btn-warning" onclick="exportToCSV()">
                    üì§ Export CSV
                </button>
                <button class="btn btn-success" onclick="document.getElementById('importFile').click()">
                    üì• Import CSV
                </button>
                <input type="file" id="importFile" accept=".csv" style="display: none;" onchange="importFromCSV(event)">
                <button class="btn btn-danger" onclick="clearAllData()">
                    üóëÔ∏è ‡πÄ‡∏Ñ‡∏•‡∏µ‡∏¢‡∏£‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                </button>
            </div>

            <!-- üìÑ Transaction List -->
            <div id="transactionList">
                <div class="text-center" style="padding: 40px; color: #999;">
                    <p>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ò‡∏∏‡∏£‡∏Å‡∏£‡∏£‡∏°</p>
                    <p>‡∏Ñ‡∏•‡∏¥‡∏Å "‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô</p>
                </div>
            </div>
        </div>
    </div>

    <!-- ‚ûï Add/Edit Transaction Modal -->
    <div id="transactionModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalTitle">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà</h2>
                <button class="close-btn" onclick="closeModal()">&times;</button>
            </div>
            <form id="transactionForm">
                <div class="form-grid">
                    <div class="form-group">
                        <label for="type">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</label>
                        <select id="type" required>
                            <option value="income">‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö</option>
                            <option value="expense">‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="recurring">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</label>
                        <select id="recurring" required>
                            <option value="false">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏¢‡πà‡∏≠‡∏¢</option>
                            <option value="true">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ñ‡∏á‡∏ó‡∏µ‡πà</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="amount">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô</label>
                        <input type="number" id="amount" step="0.01" required>
                    </div>
                    <div class="form-group">
                        <label for="category">‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</label>
                        <select id="category" required>
                            <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="date">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</label>
                        <input type="date" id="date" required>
                    </div>
                    <div class="form-group">
                        <label for="description">‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢</label>
                        <input type="text" id="description" maxlength="100">
                    </div>
                </div>
                <div class="btn-group mt-20">
                    <button type="submit" class="btn btn-primary">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
                    <button type="button" class="btn btn-danger" onclick="closeModal()">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // üìä Application State
        let transactions = [];
        let editingId = null;
        let currentFilter = 'all';

        // üè∑Ô∏è Categories
        const categories = {
            income: ['‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô', '‡πÇ‡∏ö‡∏ô‡∏±‡∏™', '‡∏Ñ‡πà‡∏≤‡∏à‡πâ‡∏≤‡∏á', '‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢', '‡∏≠‡∏∑‡πà‡∏ô‡πÜ'],
            expense: ['‡∏≠‡∏≤‡∏´‡∏≤‡∏£', '‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏û‡∏±‡∏Å', '‡∏Ñ‡πà‡∏≤‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á', '‡∏Ñ‡πà‡∏≤‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô', '‡∏Ñ‡πà‡∏≤‡πÑ‡∏ü', '‡∏Ñ‡πà‡∏≤‡∏ô‡πâ‡∏≥', '‡∏Ñ‡πà‡∏≤‡∏≠‡∏¥‡∏ô‡πÄ‡∏ó‡∏≠‡∏£‡πå‡πÄ‡∏ô‡πá‡∏ï', '‡∏Ñ‡πà‡∏≤‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå', '‡∏Ñ‡πà‡∏≤‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û', '‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ö‡∏±‡∏ô‡πÄ‡∏ó‡∏¥‡∏á', '‡∏≠‡∏∑‡πà‡∏ô‡πÜ']
        };

        // üöÄ Initialize App
        document.addEventListener('DOMContentLoaded', function() {
            loadData();
            updateSummary();
            renderTransactions();
            setupEventListeners();
            updateCategoryOptions();
            document.getElementById('date').value = new Date().toISOString().split('T')[0];
        });

        // üéØ Event Listeners
        function setupEventListeners() {
            // Filter tabs
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    currentFilter = this.dataset.filter;
                    renderTransactions();
                });
            });

            // Type change
            document.getElementById('type').addEventListener('change', updateCategoryOptions);

            // Form submission
            document.getElementById('transactionForm').addEventListener('submit', handleSubmit);
        }

        // üè∑Ô∏è Update Category Options
        function updateCategoryOptions() {
            const type = document.getElementById('type').value;
            const categorySelect = document.getElementById('category');
            const options = categories[type];
            
            categorySelect.innerHTML = '<option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</option>';
            options.forEach(option => {
                const optionElement = document.createElement('option');
                optionElement.value = option;
                optionElement.textContent = option;
                categorySelect.appendChild(optionElement);
            });
        }

        // üìù Handle Form Submit
        function handleSubmit(e) {
            e.preventDefault();
            
            const formData = {
                id: editingId || Date.now(),
                type: document.getElementById('type').value,
                amount: parseFloat(document.getElementById('amount').value),
                category: document.getElementById('category').value,
                date: document.getElementById('date').value,
                description: document.getElementById('description').value,
                recurring: document.getElementById('recurring').value === 'true',
                createdAt: editingId ? transactions.find(t => t.id === editingId).createdAt : new Date().toISOString()
            };

            if (editingId) {
                const index = transactions.findIndex(t => t.id === editingId);
                transactions[index] = formData;
            } else {
                transactions.push(formData);
            }

            saveData();
            updateSummary();
            renderTransactions();
            closeModal();
            
            // Show success message
            showNotification(editingId ? '‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!' : '‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!', 'success');
        }

        // üìä Update Summary
        function updateSummary() {
            const now = new Date();
            const currentMonth = now.getMonth();
            const currentYear = now.getFullYear();
            
            const monthlyTransactions = transactions.filter(t => {
                const tDate = new Date(t.date);
                return tDate.getMonth() === currentMonth && tDate.getFullYear() === currentYear;
            });

            const totalIncome = monthlyTransactions
                .filter(t => t.type === 'income')
                .reduce((sum, t) => sum + t.amount, 0);

            const totalExpense = monthlyTransactions
                .filter(t => t.type === 'expense')
                .reduce((sum, t) => sum + t.amount, 0);

            const balance = totalIncome - totalExpense;

            document.getElementById('totalIncome').textContent = `‡∏ø${totalIncome.toLocaleString('th-TH', {minimumFractionDigits: 2})}`;
            document.getElementById('totalExpense').textContent = `‡∏ø${totalExpense.toLocaleString('th-TH', {minimumFractionDigits: 2})}`;
            document.getElementById('balance').textContent = `‡∏ø${balance.toLocaleString('th-TH', {minimumFractionDigits: 2})}`;
            document.getElementById('transactionCount').textContent = transactions.length;
        }

        // üìã Render Transactions
        function renderTransactions() {
            const container = document.getElementById('transactionList');
            let filteredTransactions = [...transactions];

            // Apply filter
            const now = new Date();
            switch(currentFilter) {
                case 'daily':
                    filteredTransactions = transactions.filter(t => {
                        const tDate = new Date(t.date);
                        return tDate.toDateString() === now.toDateString();
                    });
                    break;
                case 'weekly':
                    const weekAgo = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000);
                    filteredTransactions = transactions.filter(t => new Date(t.date) >= weekAgo);
                    break;
                case 'monthly':
                    const currentMonth = now.getMonth();
                    const currentYear = now.getFullYear();
                    filteredTransactions = transactions.filter(t => {
                        const tDate = new Date(t.date);
                        return tDate.getMonth() === currentMonth && tDate.getFullYear() === currentYear;
                    });
                    break;
                case 'yearly':
                    const currentYearOnly = now.getFullYear();
                    filteredTransactions = transactions.filter(t => new Date(t.date).getFullYear() === currentYearOnly);
                    break;
            }

            // Sort by date (newest first)
            filteredTransactions.sort((a, b) => new Date(b.date) - new Date(a.date));

            if (filteredTransactions.length === 0) {
                container.innerHTML = `
                    <div class="text-center" style="padding: 40px; color: #999;">
                        <p>‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ò‡∏∏‡∏£‡∏Å‡∏£‡∏£‡∏°</p>
                        <p>‡∏•‡∏≠‡∏á‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ï‡∏±‡∏ß‡∏Å‡∏£‡∏≠‡∏á‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = filteredTransactions.map(transaction => `
                <div class="transaction-item ${transaction.type}">
                    <div class="transaction-info">
                        <div class="transaction-title">${transaction.category} ${transaction.recurring ? 'üîÑ' : ''}</div>
                        <div class="transaction-meta">
                            ${formatDate(transaction.date)} ‚Ä¢ ${transaction.description || '‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢'}
                        </div>
                    </div>
                    <div class="transaction-amount ${transaction.type}">
                        ${transaction.type === 'income' ? '+' : '-'}‡∏ø${transaction.amount.toLocaleString('th-TH', {minimumFractionDigits: 2})}
                    </div>
                    <div class="action-buttons">
                        <button class="icon-btn edit-btn" onclick="editTransaction(${transaction.id})" title="‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç">
                            ‚úèÔ∏è
                        </button>
                        <button class="icon-btn delete-btn" onclick="deleteTransaction(${transaction.id})" title="‡∏•‡∏ö">
                            üóëÔ∏è
                        </button>
                    </div>
                </div>
            `).join('');
        }

        // üìÖ Format Date
        function formatDate(dateString) {
            const date = new Date(dateString);
            const options = { 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric',
                weekday: 'long'
            };
            return date.toLocaleDateString('th-TH', options);
        }

        // ‚ûï Open Add Modal
        function openAddModal() {
            editingId = null;
            document.getElementById('modalTitle').textContent = '‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà';
            document.getElementById('transactionForm').reset();
            document.getElementById('date').value = new Date().toISOString().split('T')[0];
            updateCategoryOptions();
            document.getElementById('transactionModal').style.display = 'block';
        }

        // ‚úèÔ∏è Edit Transaction
        function editTransaction(id) {
            const transaction = transactions.find(t => t.id === id);
            if (!transaction) return;

            editingId = id;
            document.getElementById('modalTitle').textContent = '‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£';
            document.getElementById('type').value = transaction.type;
            document.getElementById('amount').value = transaction.amount;
            document.getElementById('category').value = transaction.category;
            document.getElementById('date').value = transaction.date;
            document.getElementById('description').value = transaction.description;
            document.getElementById('recurring').value = transaction.recurring.toString();
            
            updateCategoryOptions();
            document.getElementById('transactionModal').style.display = 'block';
        }

        // üóëÔ∏è Delete Transaction
        function deleteTransaction(id) {
            if (confirm('‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ô‡∏µ‡πâ?')) {
                transactions = transactions.filter(t => t.id !== id);
                saveData();
                updateSummary();
                renderTransactions();
                showNotification('‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!', 'success');
            }
        }

        // ‚ùå Close Modal
        function closeModal() {
            document.getElementById('transactionModal').style.display = 'none';
            editingId = null;
        }

        // üì§ Export to CSV
        function exportToCSV() {
            if (transactions.length === 0) {
                showNotification('‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏à‡∏∞ Export', 'warning');
                return;
            }

            const headers = ['ID', '‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó', '‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô', '‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà', '‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà', '‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢', '‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ñ‡∏á‡∏ó‡∏µ‡πà', '‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠'];
            const csvContent = [
                headers.join(','),
                ...transactions.map(t => [
                    t.id,
                    t.type === 'income' ? '‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö' : '‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢',
                    t.amount,
                    t.category,
                    t.date,
                    t.description || '',
                    t.recurring ? '‡πÉ‡∏ä‡πà' : '‡πÑ‡∏°‡πà',
                    new Date(t.createdAt).toLocaleString('th-TH')
                ].map(field => `"${field}"`).join(','))
            ].join('\n');

            const blob = new Blob(['\ufeff' + csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            link.setAttribute('download', `transactions_${new Date().toISOString().split('T')[0]}.csv`);
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            showNotification('Export ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!', 'success');
        }

        // üì• Import from CSV
        function importFromCSV(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const csv = e.target.result;
                    const lines = csv.split('\n');
                    const headers = lines[0].split(',').map(h => h.replace(/"/g, '').trim());
                    
                    const newTransactions = [];
                    for (let i = 1; i < lines.length; i++) {
                        if (!lines[i].trim()) continue;
                        
                        const values = lines[i].split(',').map(v => v.replace(/"/g, '').trim());
                        const transaction = {
                            id: parseInt(values[0]) || Date.now() + i,
                            type: values[1] === '‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö' ? 'income' : 'expense',
                            amount: parseFloat(values[2]) || 0,
                            category: values[3] || '‡∏≠‡∏∑‡πà‡∏ô‡πÜ',
                            date: values[4] || new Date().toISOString().split('T')[0],
                            description: values[5] || '',
                            recurring: values[6] === '‡πÉ‡∏ä‡πà',
                            createdAt: values[7] || new Date().toISOString()
                        };
                        newTransactions.push(transaction);
                    }

                    if (newTransactions.length > 0) {
                        transactions = [...transactions, ...newTransactions];
                        saveData();
                        updateSummary();
                        renderTransactions();
                        showNotification(`Import ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‡πÄ‡∏û‡∏¥‡πà‡∏° ${newTransactions.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£`, 'success');
                    }
                } catch (error) {
                    showNotification('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£ Import ‡πÑ‡∏ü‡∏•‡πå', 'error');
                    console.error('Import error:', error);
                }
            };
            reader.readAsText(file);
            event.target.value = '';
        }

        // üóëÔ∏è Clear All Data
        function clearAllData() {
            if (confirm('‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î? ‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏î‡πâ')) {
                transactions = [];
                saveData();
                updateSummary();
                renderTransactions();
                showNotification('‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!', 'success');
            }
        }

        // üíæ Save to LocalStorage
        function saveData() {
            localStorage.setItem('expenseTracker', JSON.stringify(transactions));
        }

        // üìÇ Load from LocalStorage
        function loadData() {
            const saved = localStorage.getItem('expenseTracker');
            if (saved) {
                try {
                    transactions = JSON.parse(saved);
                } catch (error) {
                    console.error('Error loading data:', error);
                    transactions = [];
                }
            }
        }

        // üîî Show Notification
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: ${type === 'success' ? 'var(--success-green)' : 
                           type === 'error' ? 'var(--danger-red)' : 
                           type === 'warning' ? 'var(--warning-orange)' : 'var(--primary-blue)'};
                color: white;
                padding: 15px 20px;
                border-radius: 8px;
                box-shadow: var(--card-shadow);
                z-index: 2000;
                animation: slideInRight 0.3s ease;
                max-width: 300px;
                font-weight: 600;
            `;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideOutRight 0.3s ease';
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }

        // üé® Add CSS animations for notifications
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideInRight {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            @keyframes slideOutRight {
                from { transform: translateX(0); opacity: 1; }
                to { transform: translateX(100%); opacity: 0; }
            }
        `;
        document.head.appendChild(style);

        // üéØ Close modal when clicking outside
        window.addEventListener('click', function(event) {
            const modal = document.getElementById('transactionModal');
            if (event.target === modal) {
                closeModal();
            }
        });

        // ‚å®Ô∏è Close modal with Escape key
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                closeModal();
            }
        });
    </script>
</body>
</html>